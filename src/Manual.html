<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="stamp.js" type="text/javascript" charset="utf-8"></script>
    <style type="text/css" media="screen">
      body {
        padding-left: 1em;
      }

      pre.prettyprint {
        background: #f5f5f5;
        padding: 1em 1.5em;
        border: solid lightgray 1px;
        display: inline-block;
      }

      .results {
        padding: 1em 1.5em;
        border: solid #080 1px;
        display: inline-block;
      }

      code {
        color: #080;
        font-family: monospace;
      }
    </style>
</head>
<body>
  <!--
  Format
  Mechanics
  API
  -->
  <h1>Format</h1>
  <p>Stamp is a small library to stamp out DOM content from a &lt;template&gt;
    element. This document describes the format that it understands, i.e. the
    attributes and the format of their values that Stamp uses to drive
    expansion.
  </p>

  <h2>Basics</h2>
<p>Stamp uses the double moustache to delineate templated values. Note
that the actual delimeters include the space before and after, so
<code>{{foo}}</code> won't be recognized, but <code>{{ foo }}</code>
will be.</p>

<p>Given a template:</p>
<pre class=prettyprint data-target=ex_1_template></pre>

<p>And the following script:</p>
<pre class=prettyprint data-target=ex_1_source></pre>

<p>After the script runs the contents of the target div will be:</p>
<pre class=prettyprint data-target=ex_1_results></pre>

<p>That is:</p>

<div class=results id=ex_1_results></div>

<template id=ex_1_template>
  <p>{{ greeting }}</p>
</template>

<script type="text/javascript" charset="utf-8" id=ex_1_source>
  var data = {
    greeting: "Hello World!",
  };

  var ctx = new Stamp.Context();
  var target = document.getElementById('ex_1_results');
  Stamp.expandInto(target, ctx.import('ex_1_template'), data);
</script>

<h2>Iterating</h2>

<p>Stamp allows iterating over both Objects and Arrays.</p>

<pre class=prettyprint data-target=ex_2_template></pre>

<p>And the following input data:</p>
<pre class=prettyprint data-target=ex_2_source></pre>

<p>After the script runs the contents of the target div will be:</p>
<pre class=prettyprint data-target=ex_2_results></pre>

<p>Which will appear as:</p>

<div class=results id=ex_2_results></div>

<template id=ex_2_template>
  <!--
  Loop over Arrays.

  Use data attributes of the form

    data-repeat-name[-index]="{{ x.y.z }}"

  and reference the values iterated over using {{ name }}.

  For arrays the 'i' state variable is also set.
  -->
  <ul data-repeat-char="{{ list }}">
    <li>{{ char }} {{ i }}</li>
  </ul>

  <!--
  If the path to the data is only one step, i.e. no "."'s then you can omit
  the braces.
  -->
  <ul data-repeat-char="list">
    <li>{{ char }} {{ i }}</li>
  </ul>

  <!--
  If you want to use a different name for the index you can supply that
  as an optional [-name] postfix to the attribute.
  -->
  <ul data-repeat-char-index="{{ list }}">
    <li>{{ char }} {{ index }}</li>
  </ul>

  <!--
  Loop over Objects.

  The format for iterating over Objects is identical. The only difference in
  behavior is that instead of "i" for index, the state variable "key" is used.
  -->
  <ul data-repeat-o="anobj">
    <li>{{ key }}: {{ o }}</li>
  </ul>

  <ul data-repeat-value-key2="anobj">
    <li>{{ key2 }}={{ value }}</li>
  </ul>

  <!-- Nested repeat loops. -->
  <ul data-repeat-value-key="top">
    <li>{{ key }}
      <ol data-repeat-value2-key2="{{ value }}">
        <!-- Note the use of "^" as a way to reference data up
          one level of nesting, and that "^"'s can be chained.
          -->
        <li>{{ ^.^.greeting }}  {{ ^.key }} - {{ key2 }}={{ value2.name }}</li>
      </ol>
    </li>
  </ul>
</template>

<script type="text/javascript" charset="utf-8" id=ex_2_source>
  var data = {
    greeting: "Hello World!",
    list: ["a", "b", "c"],
    anobj: {
      first: "Barney",
      last: "Rubble",
    },
    top: {
      foo: {
        baz: {name: "Foo Baz"},
        quux: {name: "Foo Quux"}
      },
      bar: {
        larry: {name: "Bar Larry"},
        curly: {name: "Bar Curly"}
      },
    },
  };

  var ctx = new Stamp.Context();
  var target = document.getElementById('ex_2_results');
  Stamp.expandInto(target, ctx.import('ex_2_template'), data);
</script>




<script type="text/javascript" charset="utf-8">
  toExpand = document.querySelectorAll("[data-target]");
  for (var i = 0, len = toExpand.length; i < len; i++) {
    dst = toExpand[i];
    src = document.getElementById(dst.dataset.target);
    dst.textContent = src.outerHTML;
  }
</script>

</body>
</html>
